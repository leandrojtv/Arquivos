{% extends "base.html" %}
{% block title %}Pesquisar{% endblock %}
{% block content %}
<section class="form-section">
  <div class="section-header">
    <div>
      <p class="eyebrow">Pesquisa</p>
      <h2>Encontre uma base</h2>
      <p class="subtitle">Busque pelo nome da base, ambiente, descriÃ§Ã£o ou gestor responsÃ¡vel.</p>
    </div>
    <a class="link" href="{{ url_for('list_bases') }}">Voltar para as bases</a>
  </div>
  <form action="{{ url_for('search') }}" method="get" class="card search-card">
    <label for="q">Termo de pesquisa</label>
    <div class="search-row">
      <input type="text" id="q" name="q" value="{{ query }}" placeholder="Ex.: ProduÃ§Ã£o, DataLab, Maria" />
      <button type="submit" class="button secondary">
        <span class="icon">ğŸ”</span>
        <span>Pesquisar</span>
      </button>
    </div>
  </form>
</section>

<section class="list-section">
  <div class="section-header">
    <div>
      <p class="eyebrow">Resultados</p>
      <h2>{% if query %}Encontramos {{ results|length }} resultado(s){% else %}Nada para exibir ainda{% endif %}</h2>
      <p class="subtitle">{% if not query %}Digite um termo para iniciar a pesquisa.{% elif results|length == 0 %}Tente ajustar o termo para localizar cadastros correspondentes.{% else %}Filtre mais para refinar a busca.{% endif %}</p>
    </div>
    <a class="link" href="{{ url_for('new_base_form') }}">Adicionar base</a>
  </div>
  {% if results %}
    <table>
      <thead>
        <tr>
          <th>Base</th>
          <th>Ambiente</th>
          <th>Gestor</th>
          <th class="actions">AÃ§Ãµes</th>
        </tr>
      </thead>
      <tbody>
        {% for base in results %}
          <tr>
            <td>{{ base["name"] }}</td>
            <td>{{ base["ambiente"] }}</td>
            <td>{{ base["gestor_name"] }}</td>
            <td class="actions">
              <a class="button secondary compact" href="{{ url_for('edit_base', base_id=base['id']) }}"><span class="icon">âœï¸</span><span>Editar</span></a>
              <form action="{{ url_for('delete_base', base_id=base['id']) }}" method="post" onsubmit="return confirm('Deseja excluir esta base?');">
                <button type="submit" class="button ghost danger compact"><span class="icon">ğŸ—‘ï¸</span><span>Excluir</span></button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}
</section>
{% endblock %}
