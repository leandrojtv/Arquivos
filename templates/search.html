{% extends "base.html" %}
{% block title %}Pesquisar{% endblock %}
{% block content %}
<section class="form-section">
  <div class="section-header">
    <div>
      <p class="eyebrow">Pesquisa</p>
      <h2>Encontre um cadastro</h2>
      <p class="subtitle">Busque por nome, área/coordenação ou banco de dados.</p>
    </div>
    <a class="link" href="{{ url_for('list_people') }}">Voltar para a lista</a>
  </div>
  <form action="{{ url_for('search') }}" method="get" class="card search-card">
    <label for="q">Termo de pesquisa</label>
    <div class="search-row">
      <input type="text" id="q" name="q" value="{{ query }}" placeholder="Ex.: Ana, Produção, Oracle" />
      <button type="submit">Pesquisar</button>
    </div>
  </form>
</section>

<section class="list-section">
  <div class="section-header">
    <div>
      <p class="eyebrow">Resultados</p>
      <h2>{% if query %}Encontramos {{ results|length }} resultado(s){% else %}Nada para exibir ainda{% endif %}</h2>
      <p class="subtitle">{% if not query %}Digite um termo para iniciar a pesquisa.{% elif results|length == 0 %}Tente ajustar o termo para localizar cadastros correspondentes.{% else %}Filtre mais para refinar a busca.{% endif %}</p>
    </div>
    <a class="link" href="{{ url_for('new_person_form') }}">Adicionar novo</a>
  </div>
  {% if results %}
    <table>
      <thead>
        <tr>
          <th>Nome</th>
          <th>Área / Coordenação</th>
          <th>Banco de Dados</th>
          <th class="actions">Ações</th>
        </tr>
      </thead>
      <tbody>
        {% for person in results %}
          <tr>
            <td>{{ person["name"] }}</td>
            <td>{{ person["area"] }}</td>
            <td>{{ person["database"] }}</td>
            <td class="actions">
              <a class="button secondary" href="{{ url_for('edit_person', person_id=person['id']) }}">Editar</a>
              <form action="{{ url_for('delete_person', person_id=person['id']) }}" method="post" onsubmit="return confirm('Deseja excluir este registro?');">
                <button type="submit" class="danger">Excluir</button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}
</section>
{% endblock %}
